{% extends 'main/base.html' %}
{% load static %}

{% block title %}Мій профіль - BulavaArms{% endblock %}

{% block content %}
<div class="bg-gray-50 min-h-screen pb-20">
    <!-- Breadcrumbs & Page Title -->
    <div class="bg-white border-b border-gray-200">
        <div class="container mx-auto px-4 py-6">
            <nav class="flex text-sm text-gray-500 mb-4">
                <a href="/" class="hover:text-primary-900 transition-colors">Головна</a>
                <span class="mx-2">/</span>
                <span class="text-primary-900 font-medium">Особистий кабінет</span>
            </nav>
            <h1 class="text-3xl md:text-4xl font-extrabold text-primary-900 uppercase tracking-tight">
                Мій профіль
            </h1>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">

            <!-- Sidebar Navigation -->
            <aside class="lg:col-span-1">
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden sticky top-8">
                    <!-- User Mini Profile -->
                    <div class="p-6 border-b border-gray-100 bg-primary-900 text-white text-center">
                        <div class="w-24 h-24 mx-auto bg-gray-700 rounded-full flex items-center justify-center text-3xl font-bold mb-4 border-4 border-primary-800 shadow-lg relative overflow-hidden">
                            {% if user.image %}
                                <img src="{{ user.image.url }}" alt="{{ user.username }}" class="w-full h-full object-cover">
                            {% else %}
                                <span>{{ user.first_name.0|default:user.username.0|upper }}</span>
                            {% endif %}
                        </div>
                        <h2 class="text-xl font-bold truncate">{{ user.first_name }} {{ user.last_name }}</h2>
                        <p class="text-gray-400 text-sm truncate">{{ user.email }}</p>
                    </div>

                    <!-- Navigation Links -->
                    <nav class="p-2">
                        <a href="{% url 'users:profile' %}" class="flex items-center gap-3 px-4 py-3 rounded-xl bg-primary-50 text-primary-900 font-medium mb-1 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
                            Особиста інформація
                        </a>
                        <a href="#" class="flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600 hover:bg-gray-50 hover:text-primary-900 transition-colors mb-1 group">
                            <svg class="w-5 h-5 text-gray-400 group-hover:text-primary-900 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
                            Мої замовлення
                            <span class="ml-auto bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs font-bold group-hover:bg-gray-200">0</span>
                        </a>
                        <a href="{% url 'cart:cart_detail' %}" class="flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600 hover:bg-gray-50 hover:text-primary-900 transition-colors mb-1 group">
                            <svg class="w-5 h-5 text-gray-400 group-hover:text-primary-900 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m-2.4-2H1M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17M17 13a2 2 0 100 4 2 2 0 000-4zM9 19a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
                            Кошик
                        </a>
                        <div class="h-px bg-gray-100 my-2"></div>
                        <a href="{% url 'users:logout' %}" class="flex items-center gap-3 px-4 py-3 rounded-xl text-red-600 hover:bg-red-50 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
                            Вийти
                        </a>
                    </nav>
                </div>
            </aside>

            <!-- Main Content -->
            <div class="lg:col-span-3 space-y-6">

                <!-- Personal Info Card -->
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8 relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-6 opacity-10 pointer-events-none">
                        <svg class="w-32 h-32 text-primary-900" fill="currentColor" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                    </div>

                    <div class="flex justify-between items-start mb-6 relative z-10">
                        <h2 class="text-2xl font-bold text-primary-900">Особиста інформація</h2>
                        <a href="{% url 'users:profile' %}" class="inline-flex items-center gap-2 px-4 py-2 bg-primary-50 text-primary-700 rounded-lg text-sm font-medium hover:bg-primary-100 transition-colors">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
                            Редагувати
                        </a>
                    </div>

                    <!-- Info Grid -->
                    <form action="{% url 'users:profile' %}" method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 relative z-10">
                            <!-- Field: First Name -->
                            <div class="space-y-1">
                                <label for="{{ form.first_name.id_for_label }}" class="text-xs font-bold text-gray-500 uppercase tracking-wide">Ім'я</label>
                                <input type="text" name="first_name" id="id_first_name" value="{{ form.first_name.value|default:'' }}"
                                    class="w-full px-4 py-3 rounded-lg border border-gray-200 bg-gray-50 text-gray-900 focus:bg-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all outline-none"
                                    placeholder="Введіть ваше ім'я">
                                {% if form.first_name.errors %}
                                    <p class="text-red-500 text-xs mt-1">{{ form.first_name.errors.0 }}</p>
                                {% endif %}
                            </div>

                            <!-- Field: Last Name -->
                            <div class="space-y-1">
                                <label for="{{ form.last_name.id_for_label }}" class="text-xs font-bold text-gray-500 uppercase tracking-wide">Прізвище</label>
                                <input type="text" name="last_name" id="id_last_name" value="{{ form.last_name.value|default:'' }}"
                                    class="w-full px-4 py-3 rounded-lg border border-gray-200 bg-gray-50 text-gray-900 focus:bg-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all outline-none"
                                    placeholder="Введіть ваше прізвище">
                                {% if form.last_name.errors %}
                                    <p class="text-red-500 text-xs mt-1">{{ form.last_name.errors.0 }}</p>
                                {% endif %}
                            </div>

                            <!-- Field: Username -->
                            <div class="space-y-1">
                                <label for="{{ form.username.id_for_label }}" class="text-xs font-bold text-gray-500 uppercase tracking-wide">Логін</label>
                                <input type="text" name="username" id="id_username" value="{{ form.username.value|default:'' }}"
                                    class="w-full px-4 py-3 rounded-lg border border-gray-200 bg-gray-50 text-gray-500 cursor-not-allowed"
                                    readonly>
                            </div>

                            <!-- Field: Email -->
                            <div class="space-y-1">
                                <label for="{{ form.email.id_for_label }}" class="text-xs font-bold text-gray-500 uppercase tracking-wide">Email</label>
                                <input type="email" name="email" id="id_email" value="{{ form.email.value|default:'' }}"
                                    class="w-full px-4 py-3 rounded-lg border border-gray-200 bg-gray-50 text-gray-500 cursor-not-allowed"
                                    readonly>
                            </div>

                            <!-- Field: Avatar (Optional) -->
                            <div class="md:col-span-2 space-y-1">
                                <label for="{{ form.image.id_for_label }}" class="text-xs font-bold text-gray-500 uppercase tracking-wide">Аватар</label>
                                <div class="flex items-center gap-4">
                                    <div class="w-12 h-12 rounded-full bg-gray-200 overflow-hidden flex-shrink-0">
                                        {% if user.image %}
                                            <img src="{{ user.image.url }}" class="w-full h-full object-cover">
                                        {% endif %}
                                    </div>
                                    <input type="file" name="image" id="id_image"
                                        class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100">
                                </div>
                                {% if form.image.errors %}
                                    <p class="text-red-500 text-xs mt-1">{{ form.image.errors.0 }}</p>
                                {% endif %}
                            </div>

                        </div>

                        <div class="mt-8 flex justify-end">
                            <button type="submit" class="px-6 py-3 bg-primary-900 text-white rounded-lg font-bold hover:bg-primary-800 transition-all shadow-md hover:shadow-lg transform hover:-translate-y-0.5">
                                Зберегти зміни
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Recent Orders Placeholder -->
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-primary-900">Останні замовлення</h2>
                        <a href="#" class="text-sm font-medium text-primary-600 hover:text-primary-800">Всі замовлення →</a>
                    </div>

                    <!-- Empty State -->
                    <div class="text-center py-12 bg-gray-50 rounded-xl border border-dashed border-gray-200">
                        <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-sm">
                            <svg class="w-8 h-8 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
                        </div>
                        <h3 class="text-gray-900 font-medium mb-1">У вас поки немає замовлень</h3>
                        <p class="text-gray-500 text-sm mb-4">Почніть покупки прямо зараз!</p>
                        <a href="{% url 'main:catalog' %}" class="inline-flex items-center px-4 py-2 bg-primary-900 text-white rounded-lg text-sm font-medium hover:bg-primary-800 transition-colors">
                            Перейти до каталогу
                        </a>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
{% endblock %}